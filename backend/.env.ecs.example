# =====================================================
# ReviewGuide Backend - ECS Environment Variables
# =====================================================
# Copy this file and update values for your ECS Task Definition
#
# SECRETS: Variables marked with [SECRET] should be stored in
# AWS Secrets Manager and referenced via secrets in task definition
# =====================================================

# ===================
# Application Core
# ===================
APP_NAME=ReviewGuide.ai
ENV=production
DEBUG=false
API_V1_PREFIX=/v1
APP_HOST=0.0.0.0
APP_PORT=8000

# [SECRET] Generate a strong random key: openssl rand -hex 32
SECRET_KEY=your-production-secret-key-here

# ===================
# CORS Configuration
# ===================
# Update with your actual domain(s)
CORS_ORIGINS=["https://yourdomain.com","https://www.yourdomain.com"]

# ===================
# Admin Credentials
# ===================
# [SECRET] Change these in production!
ADMIN_USERNAME=admin
ADMIN_PASSWORD=change-this-strong-password

# ===================
# Database (RDS PostgreSQL)
# ===================
# [SECRET] Format: postgresql+asyncpg://user:password@host:5432/dbname
DATABASE_URL=postgresql+asyncpg://reviewguide:your-rds-password@your-rds-endpoint.rds.amazonaws.com:5432/reviewguide_db
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_RECYCLE=3600
DB_CONNECT_TIMEOUT=10

# ===================
# Redis (ElastiCache or MemoryDB)
# ===================
# Format for ElastiCache (no TLS): redis://your-elasticache-endpoint:6379/0
# Format for MemoryDB (TLS required): rediss://your-memorydb-endpoint:6379/0
# Note: MemoryDB requires TLS - use rediss:// (double-s) not redis://
REDIS_URL=rediss://your-memorydb-endpoint.memorydb.amazonaws.com:6379/0
REDIS_MAX_CONNECTIONS=50
REDIS_RETRY_MAX_ATTEMPTS=3
REDIS_SOCKET_CONNECT_TIMEOUT=5
REDIS_HEALTH_CHECK_INTERVAL=30
REDIS_RETRY_BACKOFF_BASE=0.1
ENABLE_SEARCH_CACHE=true
USE_REDIS_FOR_HISTORY=true

# ===================
# Conversation History
# ===================
MAX_HISTORY_MESSAGES=10
MAX_USER_HISTORY_FOR_SLOT_EXTRACTION=5

# ===================
# Rate Limiting
# ===================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_GUEST_REQUESTS=10
RATE_LIMIT_GUEST_WINDOW=3600
RATE_LIMIT_AUTH_REQUESTS=100
RATE_LIMIT_AUTH_WINDOW=3600
RATE_LIMIT_PER_IP=100
RATE_LIMIT_PER_SESSION=20

# ===================
# LLM Providers
# ===================
# [SECRET] OpenAI API Key
OPENAI_API_KEY=sk-your-openai-api-key

# [SECRET] Anthropic API Key
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key

DEFAULT_MODEL=gpt-4o-mini
LITELLM_LOG_LEVEL=WARNING

# Agent-specific Models
PLANNER_MODEL=o3-mini
INTENT_MODEL=gpt-4o-mini
CLARIFIER_MODEL=gpt-4o-mini
COMPOSER_MODEL=gpt-4o-mini

# ===================
# Search Configuration
# ===================
SEARCH_PROVIDER=openai
OPENAI_SEARCH_BASE_URL=https://api.openai.com/v1
OPENAI_SEARCH_TIMEOUT=30.0
OPENAI_PRODUCT_DOMAINS=amazon.com,ebay.com,walmart.com
OPENAI_SERVICE_DOMAINS=g2.com,capterra.com,trustpilot.com
OPENAI_TRAVEL_DOMAINS=tripadvisor.com,lonelyplanet.com,booking.com

# [SECRET] Perplexity (if using)
PERPLEXITY_API_KEY=pplx-your-perplexity-key
PERPLEXITY_BASE_URL=https://api.perplexity.ai
PERPLEXITY_MODEL=sonar
PERPLEXITY_TIMEOUT=30.0
PERPLEXITY_PRODUCT_DOMAINS=ebay.com
PERPLEXITY_SERVICE_DOMAINS=g2.com,capterra.com,trustpilot.com
PERPLEXITY_TRAVEL_DOMAINS=tripadvisor.com,lonelyplanet.com

ENABLE_LLM_SEARCH_QUERY=false
SEARCH_QUERY_PRODUCT_SUFFIX=no articles, blogs, news, reviews, shop. search only purchasable products with title, price, url

# ===================
# eBay Partner Network
# ===================
# [SECRET] eBay credentials
EBAY_APP_ID=your-ebay-app-id
EBAY_CERT_ID=your-ebay-cert-id
EBAY_CAMPAIGN_ID=your-ebay-campaign-id
EBAY_AFFILIATE_CUSTOM_ID=
EBAY_MKCID=1
EBAY_MKRID=711-53200-19255-0
EBAY_TOOLID=10001
EBAY_MKEVT=1
EBAY_MAX_RESULTS=50
USE_MOCK_AFFILIATE=false

# ===================
# Amazon Associates
# ===================
# [SECRET] Amazon PA-API credentials
AMAZON_API_ENABLED=false
AMAZON_ACCESS_KEY=your-amazon-access-key
AMAZON_SECRET_KEY=your-amazon-secret-key
AMAZON_ASSOCIATE_TAG=yoursite-20
AMAZON_ASSOCIATE_TAGS=US:yoursite-20,UK:yoursite-21,DE:yoursite-21,CA:yoursite-20
AMAZON_DEFAULT_COUNTRY=US

# ===================
# IP Geolocation
# ===================
# [SECRET] IPInfo token
IPINFO_TOKEN=your-ipinfo-token

# ===================
# Affiliate Display
# ===================
SHOW_AFFILIATE_LINKS_PER_PRODUCT=false

# ===================
# Travel APIs - Hotels
# ===================
# [SECRET] RapidAPI keys
BOOKING_API_KEY=your-rapidapi-booking-key
BOOKING_AFFILIATE_ID=your-booking-affiliate-id
BOOKING_MAX_RESULTS=10

# ===================
# Travel APIs - Flights
# ===================
# [SECRET] Skyscanner via RapidAPI
SKYSCANNER_API_KEY=your-rapidapi-skyscanner-key
SKYSCANNER_MAX_RESULTS=10
SKYSCANNER_POLLING_DELAY=2

# [SECRET] Amadeus
AMADEUS_API_KEY=your-amadeus-api-key
AMADEUS_API_SECRET=your-amadeus-api-secret
AMADEUS_MAX_HOTEL_RESULTS=50
AMADEUS_MAX_HOTELS_PER_REQUEST=5
AMADEUS_MAX_HOTELS_TO_RETURN=10
AMADEUS_MAX_FLIGHT_RESULTS=10

# Expedia (if using)
EXPEDIA_API_KEY=

# ===================
# Travel Provider Selection
# ===================
# Options: mock, booking, expedia (hotels) | mock, skyscanner, amadeus (flights)
TRAVEL_HOTEL_PROVIDERS=booking
TRAVEL_FLIGHT_PROVIDERS=skyscanner
USE_MOCK_TRAVEL=false

# ===================
# Travel Cache
# ===================
ENABLE_TRAVEL_CACHE=true
TRAVEL_CACHE_TTL=3600
ENABLE_AIRPORT_CACHE=true
AIRPORT_CACHE_EXPIRY_DAYS=180

# ===================
# Link Health Monitoring
# ===================
ENABLE_LINK_HEALTH_CHECKER=true
LINK_HEALTH_CHECK_INTERVAL_HOURS=6
LINK_HEALTH_CHECK_TIMEOUT=10
LINK_HEALTH_CHECK_MAX_CONCURRENT=10

# ===================
# Logging (Production)
# ===================
LOG_ENABLED=true
LOG_LEVEL=WARNING
LOG_FORMAT=json

# ===================
# Observability (Langfuse)
# ===================
# [SECRET] Langfuse credentials
LANGFUSE_PUBLIC_KEY=pk-lf-your-public-key
LANGFUSE_SECRET_KEY=sk-lf-your-secret-key
LANGFUSE_HOST=https://cloud.langfuse.com
LANGFUSE_OTLP_ENDPOINT=/api/public/otel
ENABLE_TRACING=true
ENABLE_OPENTELEMETRY_EXPORT=true

# OpenTelemetry Batch Processing
OTEL_BATCH_SCHEDULE_DELAY_MILLIS=5000
OTEL_BATCH_MAX_QUEUE_SIZE=2048
OTEL_BATCH_MAX_EXPORT_BATCH_SIZE=512
OTEL_BATCH_EXPORT_TIMEOUT_MILLIS=30000

# ===================
# Anonymous Users
# ===================
ANONYMOUS_EMAIL_DOMAIN=@reviewguide.ai
ANONYMOUS_EMAIL_PREFIX=anonymous_
ANONYMOUS_EMAIL_RANDOM_LENGTH=16

# ===================
# Chat Stream Settings
# ===================
CHAT_EVENT_QUEUE_TIMEOUT=0.1
CHAT_STREAM_SLEEP_DELAY=0.01

# ===================
# Cache TTLs
# ===================
HALT_STATE_TTL=3600
CHAT_HISTORY_CACHE_TTL=3600